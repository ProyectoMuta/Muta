<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MUTA - Remeras</title>

  <!-- Estilos globales y de componentes -->
  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/navbar.css">
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/acceso-usuario.css">
  <link rel="stylesheet" href="css/carritoCSS/cart.css">
  <link rel="stylesheet" href="css/favoritos.css">

  <!-- estilos espec√≠ficos -->
  <link rel="stylesheet" href="css/carousel-categorias-ropa.css">
  <link rel="stylesheet" href="css/remeras.css"> 

  <!-- Librer√≠as externas -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="img/favicon.jpeg">

</head>

<body>

  <!-- Navbar -->
  <div id="navbar"></div>

  <main>
    <!-- Hero de la categor√≠a -->
    <section class="hero">
      <img src="img/fondos/fondo-remeras.png" alt="Hero Remeras">
    </section>

    <!-- Carrusel: Cl√°sicas -->
    <h2 class="section-title">CL√ÅSICAS</h2>
    <div id="carousel-remeras-clasicas" class="carousel categoria-carousel">
      <button class="carousel-prev" aria-label="Anterior">
        <i class="bi bi-chevron-left"></i>
      </button>

      <div class="carousel-track">
      <a href="producto.html?id=remera-negra"
        class="card"
        data-id="remera-negra"
        data-nombre="Remera Negra"
        data-precio="$15.000"
        data-img="img/remera-negra.png">
        <img src="img/remera-negra.png" alt="Remera Negra">
        <div class="info"><h4>Remera Negra</h4><p>$15.000</p></div>
      </a>

      <a href="producto.html?id=remera-ca√±amo"
        class="card"
        data-id="remera-ca√±amo"
        data-nombre="Remera C√°√±amo"
        data-precio="$14.000"
        data-img="img/remera-ca√±amo.png">
        <img src="img/remera-ca√±amo.png" alt="Remera C√°√±amo">
        <div class="info"><h4>Remera C√°√±amo</h4><p>$14.000</p></div>
      </a>

      <a href="producto.html?id=remera-blanca"
        class="card"
        data-id="remera-blanca"
        data-nombre="Remera Blanca"
        data-precio="$15.000"
        data-img="img/remera-blanca.png">
        <img src="img/remera-blanca.png" alt="Remera Blanca">
        <div class="info"><h4>Remera Blanca</h4><p>$15.000</p></div>
      </a>

      <a href="producto.html?id=remera-cherry"
        class="card"
        data-id="remera-cherry"
        data-nombre="Remera Cherry"
        data-precio="$15.000"
        data-img="img/remera-cherry.png">
        <img src="img/remera-cherry.png" alt="Remera Cherry">
        <div class="info"><h4>Remera Cherry</h4><p>$15.000</p></div>
      </a>

      <a href="producto.html?id=remera-neuro"
        class="card"
        data-id="remera-neuro"
        data-nombre="Remera Neuro"
        data-precio="$16.000"
        data-img="img/remera-neuro.png">
        <img src="img/remera-neuro.png" alt="Remera Neuro">
        <div class="info"><h4>Remera Neuro</h4><p>$16.000</p></div>
      </a>

      <a href="producto.html?id=remera-drip"
        class="card"
        data-id="remera-drip"
        data-nombre="Remera Drip"
        data-precio="$16.500"
        data-img="img/remera-drip.png">
        <img src="img/remera-drip.png" alt="Remera Drip">
        <div class="info"><h4>Remera Drip</h4><p>$16.500</p></div>
      </a>

      </div>

      <button class="carousel-next" aria-label="Siguiente">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>

    <!-- Carrusel: Novedades -->
    <h2 class="section-title">NOVEDADES</h2>
    <div id="carousel-remeras-novedades" class="carousel categoria-carousel">
      <button class="carousel-prev" aria-label="Anterior">
        <i class="bi bi-chevron-left"></i>
      </button>
      <div class="carousel-track">
      <a href="producto.html?id=remera-focal"
        class="card"
        data-id="remera-focal"
        data-nombre="Remera Focal"
        data-precio="$13.000"
        data-img="img/remera-focal.jpg">
        <img src="img/remera-focal.jpg" alt="Remera Focal">
        <div class="info"><h4>Remera Focal</h4><p>$13.000</p></div>
      </a>

      <a href="producto.html?id=remera-jersey"
        class="card"
        data-id="remera-jersey"
        data-nombre="Remera Jersey"
        data-precio="$16.000"
        data-img="img/remera-jersey.jpg">
        <img src="img/remera-jersey.jpg" alt="Remera Jersey">
        <div class="info"><h4>Remera Jersey</h4><p>$16.000</p></div>
      </a>

      <a href="producto.html?id=remera-vita"
        class="card"
        data-id="remera-vita"
        data-nombre="Remera Vita"
        data-precio="$16.000"
        data-img="img/remera-vita.jpg">
        <img src="img/remera-vita.jpg" alt="Remera Vita">
        <div class="info"><h4>Remera Vita</h4><p>$16.000</p></div>
      </a>

      <a href="producto.html?id=remera-mickey"
        class="card"
        data-id="remera-mickey"
        data-nombre="Remera Mickey"
        data-precio="$16.500"
        data-img="img/remera-mickey.jpg">
        <img src="img/remera-mickey.jpg" alt="Remera Mickey">
        <div class="info"><h4>Remera Mickey</h4><p>$16.500</p></div>
      </a>

      <a href="producto.html?id=remera-militar"
        class="card"
        data-id="remera-militar"
        data-nombre="Remera Militar"
        data-precio="$15.000"
        data-img="img/remera-militar.jpg">
        <img src="img/remera-militar.jpg" alt="Remera Militar">
        <div class="info"><h4>Remera Militar</h4><p>$15.000</p></div>
      </a>

      <a href="producto.html?id=remera-vitar"
        class="card"
        data-id="remera-vitar"
        data-nombre="Remera Vitar"
        data-precio="$15.500"
        data-img="img/remera-vitar.jpg">
        <img src="img/remera-vitar.jpg" alt="Remera Vitar">
        <div class="info"><h4>Remera Vitar</h4><p>$15.500</p></div>
      </a>
    </div>

      <button class="carousel-next" aria-label="Siguiente">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>

    <!-- Carrusel: Estilo MUTA -->
    <h2 class="section-title">ESTILO MUTA</h2>
    <div id="carousel-remeras-estilo" class="carousel categoria-carousel">
      <button class="carousel-prev" aria-label="Anterior">
        <i class="bi bi-chevron-left"></i>
      </button>
      <div class="carousel-track">
      <a href="producto.html?id=remera-oversize"
        class="card"
        data-id="remera-oversize"
        data-nombre="Remera Oversize"
        data-precio="$16.200"
        data-img="img/remera-oversize.jpg">
        <img src="img/remera-oversize.jpg" alt="Remera Oversize">
        <div class="info"><h4>Remera Oversize</h4><p>$16.200</p></div>
      </a>

      <a href="producto.html?id=remera-garley"
        class="card"
        data-id="remera-garley"
        data-nombre="Remera Garley"
        data-precio="$15.800"
        data-img="img/remera-garley.jpg">
        <img src="img/remera-garley.jpg" alt="Remera Garley">
        <div class="info"><h4>Remera Garley</h4><p>$15.800</p></div>
      </a>

      <a href="producto.html?id=remera-heart"
        class="card"
        data-id="remera-heart"
        data-nombre="Remera Heart"
        data-precio="$14.700"
        data-img="img/remera-heart.jpg">
        <img src="img/remera-heart.jpg" alt="Remera Heart">
        <div class="info"><h4>Remera Heart</h4><p>$14.700</p></div>
      </a>

      <a href="producto.html?id=remera-design"
        class="card"
        data-id="remera-design"
        data-nombre="Remera Design"
        data-precio="$14.900"
        data-img="img/remera-design.jpg">
        <img src="img/remera-design.jpg" alt="Remera Design">
        <div class="info"><h4>Remera Design</h4><p>$14.900</p></div>
      </a>

      <a href="producto.html?id=remera-paige"
        class="card"
        data-id="remera-paige"
        data-nombre="Remera Paige"
        data-precio="$14.600"
        data-img="img/remera-paige.jpg">
        <img src="img/remera-paige.jpg" alt="Remera Paige">
        <div class="info"><h4>Remera Paige</h4><p>$14.600</p></div>
      </a>

      <a href="producto.html?id=remera-tejida"
        class="card"
        data-id="remera-tejida"
        data-nombre="Remera Tejida"
        data-precio="$16.000"
        data-img="img/remera-tejida.jpg">
        <img src="img/remera-tejida.jpg" alt="Remera Tejida">
        <div class="info"><h4>Remera Tejida</h4><p>$16.000</p></div>
      </a>
    </div>

      <button class="carousel-next" aria-label="Siguiente">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>

            <!-- Lista din√°mica de remeras desde la base -->
    <h2 id="seccion-nuevos" class="section-title">NUEVOS INGRESOS</h2>
    <div id="carousel-nuevos" class="carousel categoria-carousel">
      <button class="carousel-prev" aria-label="Anterior">
        <i class="bi bi-chevron-left"></i>
      </button>
      <div class="carousel-track">
        <!-- üëá ac√° JS inyecta los productos -->
        <img src="img/remera-verde.png" alt="Remera verde">
      </div>
      <button class="carousel-next" aria-label="Siguiente">
        <i class="bi bi-chevron-right"></i>
      </button>

  </main>

  <!-- Modal de acceso -->
  <div id="acceso-usuario"></div>

  <!-- Footer -->
  <div id="footer"></div>
   <!-- Modal de Favoritos-->
  <div id="favoritos"></div>

  <!-- Script de carga de componentes -->
  <script src="js/componente-loader.js"></script>
  <script defer src="js/favoritos.js"></script>
  <!-- agrego carrito fijo-->
  <script src="js/carritoJS/cart.js"></script>
  <script src='https://cdn.jotfor.ms/agent/embedjs/0199edc25850752f8dd01a2672b5d39088b4/embed.js'>
</script>
  <script>
    setupCart();
  </script>

  <!-- Inicializaci√≥n de carruseles -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      setupCarousel("carousel-remeras-clasicas");
      setupCarousel("carousel-remeras-novedades");
      setupCarousel("carousel-remeras-estilo");

    });
  </script>

    <!-- üöÄ Nuevos ingresos din√°micos -->
<!-- üöÄ NUEVOS INGRESOS DIN√ÅMICOS (bloques de 8 + favoritos) -->
<script>
document.addEventListener("DOMContentLoaded", async () => {
  const raizSeccion = document.getElementById("seccion-nuevos");
  const anclaCarrusel = document.getElementById("carousel-nuevos"); // el primero del HTML (se usar√° como ‚Äúplantilla‚Äù)
  if (!raizSeccion || !anclaCarrusel) return;

  // Helpers
  const chunk = (arr, n=8) => arr.reduce((a,_,i)=> (i% n? a[a.length-1].push(arr[i]) : a.push([arr[i]]), a), []);
  const moneyAR = (n) => typeof n === "number" ? n.toLocaleString("es-AR") : (parseFloat(n||0)||0).toLocaleString("es-AR");

  try {
    const res = await fetch("backend/productController.php");
    const productos = await res.json();
    if (!Array.isArray(productos)) throw new Error("Respuesta inesperada");

    // Filtrar lo que quieras como ‚Äúnuevos‚Äù
    const nuevos = productos.filter(p => (p.categoria||"").toLowerCase()==="remeras");
    if (!nuevos.length) {
      anclaCarrusel.remove();        // oculto carrusel vac√≠o
      raizSeccion.style.display="none";
      return;
    }

    // Particionar en grupos de 8
    const grupos = chunk(nuevos, 8);

    // Limpio el carrusel ‚Äúplantilla‚Äù y lo reutilizo como el #1
    const padre = anclaCarrusel.parentElement;
    // Funci√≥n para crear un carrusel con id √∫nico
    const crearCarrusel = (id, items) => {
      const carr = anclaCarrusel.cloneNode(true);
      carr.id = id;
      const track = carr.querySelector(".carousel-track");
      track.innerHTML = items.map(p => `
        <a href="producto_dinamico.html?id=${p._id}"
           class="card"
           data-id="${p._id}"
           data-nombre="${p.nombre||''}"
           data-precio="$${moneyAR(p.precio)}"
           data-img="${(p.imagenes?.[0]) || 'img/default.jpg'}">
          <img src="${(p.imagenes?.[0]) || 'img/default.jpg'}" alt="${p.nombre||'Producto'}">
          <div class="info">
            <h4>${p.nombre||''}</h4>
            <p>$${moneyAR(p.precio)}</p>
          </div>
        </a>
      `).join("");

      // Aseguro la clase que usa favoritos.js para inyectar ‚ô•
      carr.classList.add("categoria-carousel");
      return carr;
    };

    // Inserto / reemplazo
    const primero = crearCarrusel("carousel-nuevos-1", grupos[0]);
    padre.replaceChild(primero, anclaCarrusel);

    // Carruseles extra si hay m√°s de 8
    for (let i=1;i<grupos.length;i++){
      const otro = crearCarrusel(`carousel-nuevos-${i+1}`, grupos[i]);
      // Agrego un subt√≠tulo opcional
      const h = document.createElement("h2");
      h.className = "section-title";
      h.textContent = "NUEVOS INGRESOS";
      padre.appendChild(h);
      padre.appendChild(otro);
    }

    // Inicializo todos los carruseles creados
    [...document.querySelectorAll('[id^="carousel-nuevos-"]')].forEach(c => setupCarousel(c.id));

    // Aviso a favoritos.js que hay cards nuevas para inyectar ‚ô•
    document.dispatchEvent(new CustomEvent("nuevos:render"));
  } catch (err) {
    console.error("‚ùå Error cargando nuevos ingresos:", err);
  }
});
</script>

</body>
</html>
